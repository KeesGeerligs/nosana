import chalk from 'chalk';
import { config } from '../../../../generic/config.js';
export async function validatePublicKey(publicKey) {
    try {
        const response = await fetch(`${config.backendUrl}/nodes/${publicKey.toString()}/vulnerability-check`);
        const row = await response.json();
        return {
            ...row,
            isCompromised: ['LIKELY COMPROMISED', 'COMPROMISED'].includes(row.likelihood),
            isAtRisk: [
                'LIKELY SAFE',
                'POTENTIALLY COMPROMISED',
                'LIKELY COMPROMISED',
                'COMPROMISED',
            ].includes(row.likelihood),
        };
    }
    catch (error) {
        console.error(chalk.red(`Failed to fetch node vulnerability check`, error));
        process.exit(1);
    }
}
